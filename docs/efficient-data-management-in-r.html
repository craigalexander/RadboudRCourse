<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Efficient Data Management in R | Visualising Data using R</title>
<meta name="author" content="Craig Alexander, Eilidh Jack &amp; Marnie Low">
<meta name="description" content="3.1 Tidyverse Tidyverse is a collection of R packages designed to help data scientists to make more efficient use of R. It contains the following packages (and several more, which we will: tibble...">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="Chapter 3 Efficient Data Management in R | Visualising Data using R">
<meta property="og:type" content="book">
<meta property="og:description" content="3.1 Tidyverse Tidyverse is a collection of R packages designed to help data scientists to make more efficient use of R. It contains the following packages (and several more, which we will: tibble...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Efficient Data Management in R | Visualising Data using R">
<meta name="twitter:description" content="3.1 Tidyverse Tidyverse is a collection of R packages designed to help data scientists to make more efficient use of R. It contains the following packages (and several more, which we will: tibble...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Visualising Data using R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Overview</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Getting Started</a></li>
<li><a class="active" href="efficient-data-management-in-r.html"><span class="header-section-number">3</span> Efficient Data Management in R</a></li>
<li><a class="" href="creating-graphics-with-ggplot2.html"><span class="header-section-number">4</span> Creating Graphics with ggplot2</a></li>
<li><a class="" href="handling-date-time-data-with-lubridate.html"><span class="header-section-number">5</span> Handling date-time data with lubridate</a></li>
<li><a class="" href="producing-maps-for-plotting.html"><span class="header-section-number">6</span> Producing maps for plotting</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="efficient-data-management-in-r" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Efficient Data Management in R<a class="anchor" aria-label="anchor" href="#efficient-data-management-in-r"><i class="fas fa-link"></i></a>
</h1>
<div id="tidyverse" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Tidyverse<a class="anchor" aria-label="anchor" href="#tidyverse"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://www.tidyverse.org/">Tidyverse</a> is a collection of R packages designed to help data scientists to make more efficient use of R. It contains the following packages (and several more, which we will:</p>
<ul>
<li>
<a href="http://tibble.tidyverse.org/">tibble</a> provides a “modern reimagining” of the standard <code>data.frame</code>, in R. Tibbles (or <code>tbl_df</code>s) are more flexible in terms of what they can store, but (purposefully) less flexible in terms of “sloppy code”.</li>
<li>
<a href="http://readr.tidyverse.org/">readr</a> provides alternative functions for reading in text data in tabular form. It provides faster and more consistent alternatives to <code>read.table</code> and <code>read.csv</code>.</li>
<li>
<a href="http://dplyr.tidyverse.org/">dplyr</a> provides a powerful suite of functions for data manipulation with a focus on allowing for clean and simple code. We will look at <code>dplyr</code> in more detail this week.</li>
<li>
<a href="http://ggplot2.tidyverse.org/">ggplot2</a> is a very featureful and systematic set of plotting functions, which we will focus on in this tutorial.</li>
<li>
<a href="https://lubridate.tidyverse.org/">lubridate</a> is a very useful package for handling dates and times in R. Dates and times are often tricky to deal with, and <code>lubridate</code> provides many useful functions for efficiently handling these.</li>
</ul>
</div>
<div id="pipelines" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Pipelines<a class="anchor" aria-label="anchor" href="#pipelines"><i class="fas fa-link"></i></a>
</h2>
<p>Pipelines are at the centre of all the tidyverse packages. The R package <a href="https://cran.r-project.org/web/packages/magrittr/">magrittr</a> provides a forward-pipe operator for R.</p>
<p>Suppose we have a function <code>f</code> defined in R</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="va">x</span><span class="op">^</span><span class="fl">2</span></code></pre></div>
<p>Then we can apply <code>f</code> to an argument <code>x</code> using</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">3</span>
<span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<p>The forward-pipes from magrittr allow us to rewrite this function call as</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">%&gt;%</span> <span class="va">f</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<p>instead. The advantage of this alternative notation might not become immediately clear, but its advantage becomes more obvious when looking at nested function calls.</p>
<p>Consider the R data set <code>mtcars</code>, which contains data from the 1974 edition from the US magazine Motor Trend. Suppose we want to convert the fuel consumption to litres per 100 kilometres and then only retain the cars with a fuel economy better than 10 litres per 100 kilometres.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mtcars2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html">transform</a></span><span class="op">(</span><span class="va">mtcars</span>, lp100k<span class="op">=</span><span class="fl">235.21</span><span class="op">/</span><span class="va">mpg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">mtcars2</span>, <span class="va">lp100k</span><span class="op">&lt;=</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code>##                 mpg cyl  disp  hp drat    wt  qsec vs am gear carb   lp100k
## Merc 240D      24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2 9.639754
## Fiat 128       32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1 7.259568
## Honda Civic    30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2 7.737171
## Toyota Corolla 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1 6.938348
## Fiat X1-9      27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1 8.615751
## Porsche 914-2  26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2 9.046538
## Lotus Europa   30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2 7.737171</code></pre>
<p>(If you are wondering where the number of 235.21 comes from: A US gallon is roughly 3.785 litres and a mile is roughly 1.609 kilometres, and <span class="math inline">\(\frac{100\times 3.785}{1.609}\approx 235.21\)</span>)</p>
<p>If we want to perform both steps in one go, we can nest the two calls within one another and use</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/transform.html">transform</a></span><span class="op">(</span><span class="va">mtcars</span>, lp100k<span class="op">=</span><span class="fl">235.21</span><span class="op">/</span><span class="va">mpg</span><span class="op">)</span>, <span class="va">lp100k</span><span class="op">&lt;=</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>This gives exactly the same results, but is not very easy to read and understand. It is not easy to see that the argument <code>lp100k&lt;=10</code> belongs to <code>subset</code>. When nesting function calls, the arguments get increasingly far from the function call to which they belong.</p>
<p>The <code>%&gt;%</code> operator however allows us to write this much more cleanly:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mtcars</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/transform.html">transform</a></span><span class="op">(</span>lp100k<span class="op">=</span><span class="fl">235.21</span><span class="op">/</span><span class="va">mpg</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">lp100k</span><span class="op">&lt;=</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<div id="task" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Task<a class="anchor" aria-label="anchor" href="#task"><i class="fas fa-link"></i></a>
</h3>
<p>The R code below uses pipelines. Convert it to nested function calls.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="solution" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> Solution<a class="anchor" aria-label="anchor" href="#solution"><i class="fas fa-link"></i></a>
</h3>
<p>The code generates a random sample of size 1000 (from a standard normal distribution), computes the sine of each entry and then takes the maximum.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.9999922</code></pre>
<p>In this case the nested function call is easy to read because every function only takes one argument.</p>
</div>
<div id="task-1" class="section level3" number="3.2.3">
<h3>
<span class="header-section-number">3.2.3</span> Task<a class="anchor" aria-label="anchor" href="#task-1"><i class="fas fa-link"></i></a>
</h3>
<p>Convert the R code below to pipelines.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>                       <span class="co"># Load package MASS, which contains the data</span>
<span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/transform.html">transform</a></span><span class="op">(</span><span class="va">mammals</span>, ratio<span class="op">=</span><span class="va">brain</span><span class="op">/</span><span class="va">body</span><span class="op">)</span>, <span class="va">ratio</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">ratio</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="answer" class="section level3" number="3.2.4">
<h3>
<span class="header-section-number">3.2.4</span> Answer<a class="anchor" aria-label="anchor" href="#answer"><i class="fas fa-link"></i></a>
</h3>
<p>You can use the following R code using pipelines.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>
<span class="va">mammals</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/transform.html">transform</a></span><span class="op">(</span>ratio<span class="op">=</span><span class="va">brain</span><span class="op">/</span><span class="va">body</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ratio</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">ratio</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##                  body brain    ratio
## Ground squirrel 0.101     4 39.60396</code></pre>
<p>Oddly enough, ground squirrels have a higher brain-to-body weight ratio than humans.</p>
</div>
<div id="additional-resources" class="section level3" number="3.2.5">
<h3>
<span class="header-section-number">3.2.5</span> Additional Resources<a class="anchor" aria-label="anchor" href="#additional-resources"><i class="fas fa-link"></i></a>
</h3>
<p><a href="%22https://speakerdeck.com/hadley/pipelines-for-data-analysis-in-r%22">Pipelines for Data Analysis in R</a>
Hadley Wickham has produced a series of excellent slides about pipelines, which covers much of what we will look at in this tutorial.</p>
<p><a href="%22http://r4ds.had.co.nz/pipes.html%22">Background reading: Chapter 18 of R for Data Science</a>
Chapter 18 of <em>R for Data Science</em> gives a detailed overview of pipes and some of the underpinning technology (though the latter is rather advanced).</p>
</div>
</div>
<div id="tibbles" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Tibbles<a class="anchor" aria-label="anchor" href="#tibbles"><i class="fas fa-link"></i></a>
</h2>
<p>The package <a href="https://cran.r-project.org/web/packages/tibble/">tibble</a> provides <code>tbl_df</code>’s (or “tibbles”, which is easier to pronounce). They are a modern take on the built-in class <code>data.frame</code>.</p>
<p>One key advantage of tibbles is that they can store anything. A <code>data.frame</code> can only store a single value per “cell”, for example a number or a character string. However, in a tibble, you can store a list or even another tibble in a cell. An example of this is the tibble <code>starwars</code> from the package <code>dplyr</code>. The column <code>starships</code> contains for each row the list of starships flown by that character (which is a list of different length depending on the character.)</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>                             <span class="co"># Load library dplyr which contains the data</span>
<span class="va">starwars</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"starships"</span><span class="op">)</span><span class="op">]</span>          <span class="co"># Print columns name and starships</span></code></pre></div>
<pre><code>## # A tibble: 87 × 2
##    name               starships
##    &lt;chr&gt;              &lt;list&gt;   
##  1 Luke Skywalker     &lt;chr [2]&gt;
##  2 C-3PO              &lt;chr [0]&gt;
##  3 R2-D2              &lt;chr [0]&gt;
##  4 Darth Vader        &lt;chr [1]&gt;
##  5 Leia Organa        &lt;chr [0]&gt;
##  6 Owen Lars          &lt;chr [0]&gt;
##  7 Beru Whitesun lars &lt;chr [0]&gt;
##  8 R5-D4              &lt;chr [0]&gt;
##  9 Biggs Darklighter  &lt;chr [1]&gt;
## 10 Obi-Wan Kenobi     &lt;chr [5]&gt;
## # … with 77 more rows</code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">starwars</span><span class="op">[</span><span class="fl">10</span>,<span class="st">"starships"</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>              <span class="co"># Starships flown by Obi-Wan</span></code></pre></div>
<pre><code>## [[1]]
## [1] "Jedi starfighter"         "Trade Federation cruiser"
## [3] "Naboo star skiff"         "Jedi Interceptor"        
## [5] "Belbullab-22 starfighter"</code></pre>
<p>We could not have stored this information in a data frame. We would have had to either store the information across several data frames or stored the list of starships as a character string.</p>
<div id="creating-tibbles" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Creating tibbles<a class="anchor" aria-label="anchor" href="#creating-tibbles"><i class="fas fa-link"></i></a>
</h3>
<p>We can create tibbles using the function <code>tibble</code>. We can create the tibble from above using</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kidstibble</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sarah"</span>, <span class="st">"John"</span><span class="op">)</span>, age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">11</span><span class="op">)</span>, weight<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">28</span><span class="op">)</span>,
                     height<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">101</span>,<span class="fl">132</span><span class="op">)</span>, gender<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"f"</span>, <span class="st">"m"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>In other words, the function <code>tibble</code> assembles a tibble on a column-by-column basis (akin to using <code>cbind</code>).</p>
<p>The function <code>tribble</code> (“transposed tibble”) lets you create a tibble on a row-by-bow basis (akin to using <code>rbind</code>), which is typically more legible when creating a matrix in code.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kidstibble</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>,   <span class="op">~</span><span class="va">age</span>, <span class="op">~</span><span class="va">weight</span>, <span class="op">~</span><span class="va">height</span>, <span class="op">~</span><span class="va">gender</span>,
                      <span class="st">"Sarah"</span>,    <span class="fl">4</span>,      <span class="fl">15</span>,     <span class="fl">101</span>,     <span class="st">"f"</span>,
                      <span class="st">"John"</span>,    <span class="fl">11</span>,      <span class="fl">28</span>,     <span class="fl">132</span>,     <span class="st">"m"</span><span class="op">)</span></code></pre></div>
</div>
<div id="working-with-tibbles" class="section level3" number="3.3.2">
<h3>
<span class="header-section-number">3.3.2</span> Working with tibbles<a class="anchor" aria-label="anchor" href="#working-with-tibbles"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Variables/Columns can be accessed and added using <code>tibble$varname</code> (<code>varname</code> needs to be fully spelled out). You can also access a column using <code>tibble[,"varname"]</code> or <code>tibble[["varname"]]</code>.</li>
<li>Rows can be selected using <code>tibble[rowindices,]</code> (note that you cannot use row names).</li>
<li>Individual cells can be accessed using <code>tibble[rowindices, colindices]</code>.</li>
</ul>
</div>
<div id="subsetting-tibbles-always-results-in-a-tibble" class="section level3" number="3.3.3">
<h3>
<span class="header-section-number">3.3.3</span> Subsetting tibbles always results in a tibble<a class="anchor" aria-label="anchor" href="#subsetting-tibbles-always-results-in-a-tibble"><i class="fas fa-link"></i></a>
</h3>
<p>Tibbles are also more consistent. Subsetting tibbles always results in a tibble.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kidstibble</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>                            <span class="co"># Result is a tibble</span></code></pre></div>
<pre><code>## # A tibble: 2 × 1
##   name 
##   &lt;chr&gt;
## 1 Sarah
## 2 John</code></pre>
<p>In contrast, subsetting a data frame or matrix is not guaranteed to result in a data frame or matrix (unless you use <code>drop=FALSE</code>). If the result is a single column or row, subsetting a data frame or matrix results in a vector.</p>
<p>This “dropping” of the dimension can be very useful when using R interactively, but can be the source of many issues in more complex projects, when programmers incorrectly assume that subsetting a data frame or matrix will always result in another data frame or matrix, rather than possibly just a vector (it is thus a good idea to always use <code>drop=FALSE</code> when working with data frames or matrices in complex projects).</p>
<p><a href="%22https://github.com/rstudio/cheatsheets/raw/main/data-import.pdf%22">Data Import Cheat Sheet</a>
RStudio’s cheat sheet for data import also covers tibbles.</p>
</div>
</div>
<div id="reading-in-data-using-readr" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Reading in data using readr<a class="anchor" aria-label="anchor" href="#reading-in-data-using-readr"><i class="fas fa-link"></i></a>
</h2>
<p>The package <a href="https://cran.r-project.org/web/packages/readr/index.html">readr</a> contains alternatives to the functions <code>read.table</code> and <code>read.csv</code>. The alternative functions from <code>readr</code> have four main advantages.</p>
<ul>
<li>They read in the data a lot faster and can show a progress bar (though this is only relevant for really big data sets).</li>
<li>They store the data straight in a tibble, rather than a data frame.</li>
<li>They allow specifying the intended data type for each column and thus make it easier to identify rows which cause problems.</li>
<li>They are less intrusive: they don’t automatically convert character strings to factors and do not change column names (<code>read.table</code> and <code>read.csv</code> will for example remove spaces from variable names and replace them by full stops). The functions from <code>readr</code> are also guaranteed to give the same result irrespective of the platform or operating system they are run under.</li>
</ul>
<p><code>readr</code> provides the following functions.</p>
<ul>
<li>
<code>read_csv</code> reads in comma-separated files. <code>read_csv2</code> reads in files which are semicolon-separated (common in countries like France or Germany, where a comma is used as decimal separator).</li>
<li>
<code>read_tsv</code> reads in tab-separated files.</li>
<li>
<code>read_delim</code> is the most general function (like <code>read.table</code>). The delimiter has to be specified using the argument <code>delim</code>.</li>
<li>
<code>read_fwd</code> reads in fixed-width files.</li>
</ul>
<p>All functions assume that the first row contains the column/variable names. If this is not the case, set the optional argument <code>col_names</code> to <code>FALSE</code> or to a character vector containing the intended column names.</p>
<p>The strings used to encode missing values can be specified using the optional argument <code>na</code>.</p>
<p>For example, we can read in the file <a href="https://raw.githubusercontent.com/UofGAnalyticsData/R/main/Week%203/chol.txt">chol.txt</a> using</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span>
<span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span><span class="st">"chol.txt"</span>, delim<span class="op">=</span><span class="st">" "</span>, col_names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ldl"</span>, <span class="st">"hdl"</span>, <span class="st">"trig"</span>,
                                              <span class="st">"age"</span>, <span class="st">"gender"</span>, <span class="st">"smoke"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 13 Columns: 6
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: " "
## chr (2): gender, smoke
## dbl (4): ldl, hdl, trig, age
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre><code>## # A tibble: 13 × 6
##      ldl   hdl  trig   age gender smoke    
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
##  1   175    25   148    39 female no       
##  2   196    36    92    32 female no       
##  3   139    65    NA    42 male   &lt;NA&gt;     
##  4   162    37   139    30 female ex-smoker
##  5   140   117    59    42 female ex-smoker
##  6   147    51   126    65 female ex-smoker
##  7    82    81    NA    57 male   no       
##  8   165    63   120    48 male   current  
##  9   149    49    NA    32 female no       
## 10    95    54   157    55 female ex-smoker
## 11   169    59    67    48 female no       
## 12   174   117   168    41 female no       
## 13    91    52   146    69 female current</code></pre>
<p>Note that functions from <code>readr</code> show the data type it has used for each column. This makes it easier to spot mistakes like missing values not coded as expected, in which case a numeric column would show up as a character string.</p>
<p>For example, we can read in the file <a href="https://github.com/UofGAnalyticsData/R/raw/main/Week%203/chol.csv">chol.csv</a> using</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span>
<span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"chol.csv"</span>, na<span class="op">=</span><span class="st">"."</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 13 Columns: 6
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr (2): gender, smoke
## dbl (4): ldl, hdl, trig, age
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre><code>## # A tibble: 13 × 6
##      ldl   hdl  trig   age gender smoke    
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
##  1   175    25   148    39 female no       
##  2   196    36    92    32 female no       
##  3   139    65    NA    42 male   NA       
##  4   162    37   139    30 female ex-smoker
##  5   140   117    59    42 female ex-smoker
##  6   147    51   126    65 female ex-smoker
##  7    82    81    NA    57 male   no       
##  8   165    63   120    48 male   current  
##  9   149    49    NA    32 female no       
## 10    95    54   157    55 female ex-smoker
## 11   169    59    67    48 female no       
## 12   174   117   168    41 female no       
## 13    91    52   146    69 female current</code></pre>
<div id="task-2" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Task<a class="anchor" aria-label="anchor" href="#task-2"><i class="fas fa-link"></i></a>
</h3>
<p>Read the data files <a href="https://github.com/UofGAnalyticsData/R/raw/main/Week%203/cars.csv">cars.csv</a> and <a href="https://github.com/UofGAnalyticsData/R/raw/main/Week%203/ships.txt">ships.txt</a> into R using the functions from <code>readr</code>.</p>
</div>
<div id="answer-1" class="section level3" number="3.4.2">
<h3>
<span class="header-section-number">3.4.2</span> Answer<a class="anchor" aria-label="anchor" href="#answer-1"><i class="fas fa-link"></i></a>
</h3>
<p>The first line of the file <code>cars.csv</code> contains the variable names and the fields are separated by commas. Missing values are encoded as asterisks.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"cars.csv"</span>, na<span class="op">=</span><span class="st">"*"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 20 Columns: 5
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr (2): Manufacturer, Model
## dbl (3): MPG, Displacement, Horsepower
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cars</span></code></pre></div>
<pre><code>## # A tibble: 20 × 5
##    Manufacturer Model     MPG Displacement Horsepower
##    &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1 Chevrolet    Camaro     19          3.4        160
##  2 Oldsmobile   Achieva    NA          2.3        155
##  3 Dodge        Spirit     22          2.5        100
##  4 Chevrolet    Astro      NA          4.3        165
##  5 Chevrolet    Corsica    25          2.2        110
##  6 Volkswagen   Corrado    18          2.8        178
##  7 Dodge        Stealth    18          3          300
##  8 Volkswagen   Fox        25          1.8         81
##  9 Cadillac     DeVille    16          4.9        200
## 10 Hyundai      Excel      29          1.5         81
## 11 Toyota       Tercel     32          1.5         82
## 12 Dodge        Colt       29          1.5         92
## 13 Volkswagen   Passat     21          2          134
## 14 Geo          Storm      30          1.6         90
## 15 Toyota       Previa     18          2.4        138
## 16 Nissan       Sentra     29          1.6        110
## 17 Toyota       Celica     25          2.2        135
## 18 Honda        Civic      42          1.5        102
## 19 Dodge        Caravan    17          3          142
## 20 Hyundai      Sonata     20          2          128</code></pre>
<p>We could have also used the function <code>read_delim</code>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span><span class="st">"cars.csv"</span>, delim<span class="op">=</span><span class="st">","</span>, na<span class="op">=</span><span class="st">"*"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 20 Columns: 5
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr (2): Manufacturer, Model
## dbl (3): MPG, Displacement, Horsepower
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre><code>## # A tibble: 20 × 5
##    Manufacturer Model     MPG Displacement Horsepower
##    &lt;chr&gt;        &lt;chr&gt;   &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1 Chevrolet    Camaro     19          3.4        160
##  2 Oldsmobile   Achieva    NA          2.3        155
##  3 Dodge        Spirit     22          2.5        100
##  4 Chevrolet    Astro      NA          4.3        165
##  5 Chevrolet    Corsica    25          2.2        110
##  6 Volkswagen   Corrado    18          2.8        178
##  7 Dodge        Stealth    18          3          300
##  8 Volkswagen   Fox        25          1.8         81
##  9 Cadillac     DeVille    16          4.9        200
## 10 Hyundai      Excel      29          1.5         81
## 11 Toyota       Tercel     32          1.5         82
## 12 Dodge        Colt       29          1.5         92
## 13 Volkswagen   Passat     21          2          134
## 14 Geo          Storm      30          1.6         90
## 15 Toyota       Previa     18          2.4        138
## 16 Nissan       Sentra     29          1.6        110
## 17 Toyota       Celica     25          2.2        135
## 18 Honda        Civic      42          1.5        102
## 19 Dodge        Caravan    17          3          142
## 20 Hyundai      Sonata     20          2          128</code></pre>
<p>The first line of the file <code>ships.txt</code> contains the variable names and the fields are separated by whitespace. Missing values are encoded as “.”.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ships</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span><span class="st">"ships.txt"</span>, delim<span class="op">=</span><span class="st">' '</span> , na<span class="op">=</span><span class="st">"."</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 40 Columns: 5
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: " "
## chr (1): type
## dbl (4): year, period, service, incidents
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ships</span></code></pre></div>
<pre><code>## # A tibble: 40 × 5
##    type   year period service incidents
##    &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
##  1 A        60     60     127         0
##  2 A        60     75      63         0
##  3 A        65     60      NA         3
##  4 A        65     75    1095         4
##  5 A        70     60    1512         6
##  6 A        70     75    3353        18
##  7 A        75     60       0         0
##  8 A        75     75    2244        11
##  9 B        60     60   44882        39
## 10 B        60     75   17176        29
## # … with 30 more rows</code></pre>
</div>
<div id="specifying-column-types" class="section level3" number="3.4.3">
<h3>
<span class="header-section-number">3.4.3</span> Specifying column types<a class="anchor" aria-label="anchor" href="#specifying-column-types"><i class="fas fa-link"></i></a>
</h3>
<p>The functions from <code>readr</code> allow specifying the expected column types. This is especially important when writing which will then be run automatically. It provides an easy way of ensuring that the data provided is of the expected format.</p>
<p>The easiest way of specifying expected column types is to provide a character string with each letters standing for a column</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Letter</th>
<th>Meaning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>c</code></td>
<td>character</td>
</tr>
<tr class="even">
<td><code>i</code></td>
<td>integer</td>
</tr>
<tr class="odd">
<td><code>n</code></td>
<td>number</td>
</tr>
<tr class="even">
<td><code>d</code></td>
<td>double</td>
</tr>
<tr class="odd">
<td><code>l</code></td>
<td>logical</td>
</tr>
<tr class="even">
<td><code>D</code></td>
<td>date</td>
</tr>
<tr class="odd">
<td><code>T</code></td>
<td>date time</td>
</tr>
<tr class="even">
<td><code>t</code></td>
<td>time</td>
</tr>
<tr class="odd">
<td><code>?</code></td>
<td>guess the type</td>
</tr>
<tr class="even">
<td>
<code>_</code> or <code>-</code>
</td>
<td>skip the column</td>
</tr>
</tbody>
</table></div>
<p>So for the data file chol.csv we would expect the first four columns to be integers and the latter two to be character strings, so we would use</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">chol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"chol.csv"</span>, na<span class="op">=</span><span class="st">"."</span>, col_types<span class="op">=</span><span class="st">"iiiicc"</span><span class="op">)</span></code></pre></div>
<p>Specifying the expected column types can help pinpointing problems when reading in data. Suppose we had forgotten that missing values are coded using “<code>.</code>” in this data file. If we use …</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">chol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"chol.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 13 Columns: 6
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr (3): trig, gender, smoke
## dbl (3): ldl, hdl, age
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>… we can see from the output that <code>trig</code> was read in as a character string, but we do not know why.</p>
<p>However, if we use …</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">chol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"chol.csv"</span>, col_types<span class="op">=</span><span class="st">"iiiicc"</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: One or more parsing issues, see `problems()` for details</code></pre>
<p>… we obtain a warning and can print the problematic rows using</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/problems.html">problems</a></span><span class="op">(</span><span class="va">chol</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##     row   col expected   actual file                                            
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt;                                           
## 1     4     3 an integer .      /Users/Craig/Library/CloudStorage/OneDrive-Shar…
## 2     8     3 an integer .      /Users/Craig/Library/CloudStorage/OneDrive-Shar…
## 3    10     3 an integer .      /Users/Craig/Library/CloudStorage/OneDrive-Shar…</code></pre>
<p>The output from <code>problems</code> shows us that for three rows (3, 7 and 9) the data in <code>chol.csv</code> was not of the expected format: a value of <code>.</code> is not compatible with the column being numeric. This makes it easy to identify the cause of the problem (NAs coded as “<code>.</code>”) and rectify the issue.</p>
</div>
<div id="additional-resources-1" class="section level3" number="3.4.4">
<h3>
<span class="header-section-number">3.4.4</span> Additional Resources<a class="anchor" aria-label="anchor" href="#additional-resources-1"><i class="fas fa-link"></i></a>
</h3>
<p><a href="%22https://github.com/rstudio/cheatsheets/raw/main/data-import.pdf%22">Data Import Cheat Sheet</a>
RStudio’s cheat sheet for data import also covers <code>readr</code>.</p>
<p><a href="%22http://r4ds.had.co.nz/data-import.html%22">Background reading: Chapter 11 of R for Data Science</a>
Chapter 11 of <em>R for Data Science</em> gives a detailed overview of the functions in <code>readr</code>. It explains in some more detail how the functions in <code>readr</code> parse files. over pipes and also covers the functions from <code>readr</code> that dead with writing files.</p>
</div>
</div>
<div id="efficient-data-manipulation-using-dplyr" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Efficient data manipulation using dplyr<a class="anchor" aria-label="anchor" href="#efficient-data-manipulation-using-dplyr"><i class="fas fa-link"></i></a>
</h2>
<p>In this section we will work with data from Paris’ Vélib’ bicycle sharing system available through <a href="https://developer.jcdecaux.com/">JCDecaux’s API</a> for <a href="https://developer.jcdecaux.com/#/opendata/">open cycle data</a>.</p>
<p>The data consists of the number of bikes available and the number of bike stands available at every Vélib’ station, recorded every five minutes over six hours on a Tuesday afternoon in October 2017.</p>
<p>The data consists of two tibbles. The first, <code>bikes</code> contains data on the number of available bikes and stands at each station.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Variable</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>name</code></td>
<td>Name of the station</td>
</tr>
<tr class="even">
<td><code>available_bikes</code></td>
<td>Number of available at that time</td>
</tr>
<tr class="odd">
<td><code>available_bike_stands</code></td>
<td>Number of available bike stands</td>
</tr>
<tr class="even">
<td><code>time</code></td>
<td>Decimal time for which the number have been recorded</td>
</tr>
</tbody>
</table></div>
<p>The second, <code>stations</code> contains additional information about each station.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Variable</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>name</code></td>
<td>Unique name of the station</td>
</tr>
<tr class="even">
<td><code>id</code></td>
<td>Internal ID number of the station</td>
</tr>
<tr class="odd">
<td><code>address</code></td>
<td>Address of where the station is located</td>
</tr>
<tr class="even">
<td><code>lng</code></td>
<td>GPS coordinate (longitude)</td>
</tr>
<tr class="odd">
<td><code>lat</code></td>
<td>GPS coordinate (latitude)</td>
</tr>
<tr class="even">
<td><code>departement</code></td>
<td>Département in which the station is located</td>
</tr>
</tbody>
</table></div>
<p>You can load the data into R using</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="st">"https://github.com/UofGAnalyticsData/R/raw/main/Week%204/velib"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="overview-the-key-functions-verbs-for-dplyr" class="section level3" number="3.5.1">
<h3>
<span class="header-section-number">3.5.1</span> Overview: the key functions (“verbs”) for <code>dplyr</code><a class="anchor" aria-label="anchor" href="#overview-the-key-functions-verbs-for-dplyr"><i class="fas fa-link"></i></a>
</h3>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Function (“verb”)</th>
<th>Description</th>
<th>R base equivalent(s)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>filter</code></td>
<td>Select observations/rows</td>
<td><code>subset</code></td>
</tr>
<tr class="even">
<td><code>slice</code></td>
<td>Select observations by row numbers</td>
<td><code>[idx,]</code></td>
</tr>
<tr class="odd">
<td><code>select</code></td>
<td>Select variables/column</td>
<td>
<code>$</code> or <code>[,sel]</code>
</td>
</tr>
<tr class="even">
<td><code>mutate</code></td>
<td>Create new variables/column</td>
<td><code>transform</code></td>
</tr>
<tr class="odd">
<td><code>arrange</code></td>
<td>Sort observations/rows</td>
<td><code>order</code></td>
</tr>
<tr class="even">
<td><code>group_by</code></td>
<td>Group observations by variable</td>
<td>
<code>by</code> or <code>aggregate</code>
</td>
</tr>
<tr class="odd">
<td><code>summarise</code></td>
<td>Calculate summary statistics</td>
<td>
<code>by</code> or <code>aggregate</code>
</td>
</tr>
</tbody>
</table></div>
<p>The functions in <code>dplyr</code> are designed to be used with tibbles, but they also work with data frames. When invoked with a data frame, they will return a data frame as long as this is possible.</p>
</div>
<div id="selecting-observations-rows-using-filter-and-slice" class="section level3" number="3.5.2">
<h3>
<span class="header-section-number">3.5.2</span> Selecting observations (rows) using <code>filter</code> and <code>slice</code><a class="anchor" aria-label="anchor" href="#selecting-observations-rows-using-filter-and-slice"><i class="fas fa-link"></i></a>
</h3>
<div id="filter" class="section level4" number="3.5.2.1">
<h4>
<span class="header-section-number">3.5.2.1</span> <code>filter</code><a class="anchor" aria-label="anchor" href="#filter"><i class="fas fa-link"></i></a>
</h4>
<p>The function <code>filter</code> is used to select observations (or rows) in a similar way to the base R function <code>subset</code>.</p>
<p>Suppose we want to print all bike stations in Paris (rather than other départements from Île de France)</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="va">stations75</span> <span class="op">&lt;-</span> <span class="va">stations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
                <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">departement</span><span class="op">==</span><span class="st">"Paris"</span><span class="op">)</span>
<span class="va">stations75</span></code></pre></div>
<pre><code>## # A tibble: 743 × 6
##    name                                       id address   lng   lat departement
##    &lt;chr&gt;                                   &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      
##  1 PORT SOLFERINO (STATION MOBILE)           901 BERGES…  2.32  48.9 Paris      
##  2 QUAI MAURIAC  / PONT DE BERCY             903 FETE D…  2.37  48.8 Paris      
##  3 17/19 PLACE JOFFRE / ECOLE MILITAIRE      904 ECOLE …  2.30  48.9 Paris      
##  4 CONCORDE/BERGES DE SEINE (STATION MOBI…   905 BERGES…  2.32  48.9 Paris      
##  5 PORT DU GROS CAILLOU (STATION MOBILE)     908 BERGES…  2.31  48.9 Paris      
##  6 PONT D'ARCOLE (STATION MOBILE)            909 Voie G…  2.35  48.9 Paris      
##  7 ILE DE LA CITE PONT NEUF                 1001 41 QUA…  2.34  48.9 Paris      
##  8 PLACE DU CHATELET                        1002 14 AVE…  2.35  48.9 Paris      
##  9 RIVOLI SAINT DENIS                       1003 7 RUE …  2.35  48.9 Paris      
## 10 MARGUERITE DE NAVARRE                    1004 12 RUE…  2.35  48.9 Paris      
## # … with 733 more rows</code></pre>
<p>Note the use of a double <code>==</code> to test whether the département is equal to “Paris”.</p>
<p>We can create more complex expressions using the standard logical operators <code>&amp;</code> (“and”), <code>|</code> (“or”) and <code>!</code> (“not”). Note that you <em>cannot</em> use <code>&amp;&amp;</code> and <code>||</code> in this context, as they only work with scalar arguments.</p>
<p>For example, if we want to extract the stations which are in Paris or Hauts-de-Seine we can use</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stations7592</span> <span class="op">&lt;-</span> <span class="va">stations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
                  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">departement</span><span class="op">==</span><span class="st">"Paris"</span> <span class="op">|</span> <span class="va">departement</span><span class="op">==</span><span class="st">"Hauts-de-Seine"</span><span class="op">)</span></code></pre></div>
<p>Rather than using a logical or we could have used <code>%in%</code>:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stations7592</span> <span class="op">&lt;-</span> <span class="va">stations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
                  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">departement</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Paris"</span> , <span class="st">"Hauts-de-Seine"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Even though the functions from <code>dplyr</code> are designed to be used with pipelines, you can also provide the data set as first argument:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stations7592</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">stations</span>, <span class="va">departement</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Paris"</span> , <span class="st">"Hauts-de-Seine"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="slice" class="section level4" number="3.5.2.2">
<h4>
<span class="header-section-number">3.5.2.2</span> <code>slice</code><a class="anchor" aria-label="anchor" href="#slice"><i class="fas fa-link"></i></a>
</h4>
<p>You can use the function <code>slice</code> to select observations based on their row numbers.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 6
##   name                                     id address      lng   lat departement
##   &lt;chr&gt;                                 &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      
## 1 PORT DU GROS CAILLOU (STATION MOBILE)   908 BERGES DE…  2.31  48.9 Paris      
## 2 PONT D'ARCOLE (STATION MOBILE)          909 Voie Geor…  2.35  48.9 Paris      
## 3 ILE DE LA CITE PONT NEUF               1001 41 QUAI D…  2.34  48.9 Paris</code></pre>
<p>selects the observations in rows 5 to 7 and is equivalent to</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stations</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span>,<span class="op">]</span></code></pre></div>
<pre><code>## # A tibble: 3 × 6
##   name                                     id address      lng   lat departement
##   &lt;chr&gt;                                 &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      
## 1 PORT DU GROS CAILLOU (STATION MOBILE)   908 BERGES DE…  2.31  48.9 Paris      
## 2 PONT D'ARCOLE (STATION MOBILE)          909 Voie Geor…  2.35  48.9 Paris      
## 3 ILE DE LA CITE PONT NEUF               1001 41 QUAI D…  2.34  48.9 Paris</code></pre>
</div>
</div>
<div id="task-3" class="section level3" number="3.5.3">
<h3>
<span class="header-section-number">3.5.3</span> Task<a class="anchor" aria-label="anchor" href="#task-3"><i class="fas fa-link"></i></a>
</h3>
<p>Identify the stations which had more than 60 bikes available at 3pm (i.e. <code>time</code> taking the value 15).</p>
</div>
<div id="answer-2" class="section level3" number="3.5.4">
<h3>
<span class="header-section-number">3.5.4</span> Answer<a class="anchor" aria-label="anchor" href="#answer-2"><i class="fas fa-link"></i></a>
</h3>
<p>You can use the following R code:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bikes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">time</span><span class="op">==</span><span class="fl">15</span> <span class="op">&amp;</span> <span class="va">available_bikes</span><span class="op">&gt;</span><span class="fl">60</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   name                available_bikes available_bike_stands  time
##   &lt;chr&gt;                         &lt;int&gt;                 &lt;int&gt; &lt;dbl&gt;
## 1 MUSÉE D'ORSAY                    63                     2    15
## 2 DUPLEIX                          65                     3    15
## 3 ASSEMBLEE NATIONALE              62                     0    15
## 4 SAINT EMILION                    65                     1    15
## 5 METZ                             63                     1    15
## 6 PRIMO LEVI                       61                     1    15</code></pre>
</div>
<div id="selecting-variables-columns-using-select" class="section level3" number="3.5.5">
<h3>
<span class="header-section-number">3.5.5</span> Selecting variables (columns) using <code>select</code><a class="anchor" aria-label="anchor" href="#selecting-variables-columns-using-select"><i class="fas fa-link"></i></a>
</h3>
<p>The function <code>select</code> can be used to subset the variables (columns) of a data set.</p>
<p>You can either specify the columns to retain or (with a minus) those you do not want to retain.</p>
<p>We can only retain the name and département of each station using either</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stations.small</span> <span class="op">&lt;-</span> <span class="va">stations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
                     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">departement</span><span class="op">)</span>
<span class="va">stations.small</span></code></pre></div>
<pre><code>## # A tibble: 928 × 2
##    name                                      departement
##    &lt;chr&gt;                                     &lt;chr&gt;      
##  1 PORT SOLFERINO (STATION MOBILE)           Paris      
##  2 QUAI MAURIAC  / PONT DE BERCY             Paris      
##  3 17/19 PLACE JOFFRE / ECOLE MILITAIRE      Paris      
##  4 CONCORDE/BERGES DE SEINE (STATION MOBILE) Paris      
##  5 PORT DU GROS CAILLOU (STATION MOBILE)     Paris      
##  6 PONT D'ARCOLE (STATION MOBILE)            Paris      
##  7 ILE DE LA CITE PONT NEUF                  Paris      
##  8 PLACE DU CHATELET                         Paris      
##  9 RIVOLI SAINT DENIS                        Paris      
## 10 MARGUERITE DE NAVARRE                     Paris      
## # … with 918 more rows</code></pre>
<p>or</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stations.small</span> <span class="op">&lt;-</span> <span class="va">stations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">id</span>, <span class="op">-</span><span class="va">address</span>, <span class="op">-</span><span class="va">lng</span>, <span class="op">-</span><span class="va">lat</span><span class="op">)</span></code></pre></div>
<p>You can also use <code>select</code> to change the order of the columns of a data set.</p>
</div>
<div id="adding-new-variables-using-mutate" class="section level3" number="3.5.6">
<h3>
<span class="header-section-number">3.5.6</span> Adding new variables using <code>mutate</code><a class="anchor" aria-label="anchor" href="#adding-new-variables-using-mutate"><i class="fas fa-link"></i></a>
</h3>
<p>The function <code>mutate</code> can be used to create new variables (columns) in a data set. <code>mutate</code> is similar in functionality to the base R function <code>transform</code>.</p>
<p>We can add the total number of stands to the data set <code>bikes</code> using</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bikes</span> <span class="op">&lt;-</span> <span class="va">bikes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>total_stands <span class="op">=</span> <span class="va">available_bikes</span><span class="op">+</span><span class="va">available_bike_stands</span><span class="op">)</span></code></pre></div>
<p>More than one new variable can be defined by adding further arguments to <code>mutate</code>.</p>
<p><code>transmute</code> is a sibling of <code>mutate</code>. Just like <code>mutate</code> it creates new columns. It however also removes all existing columns so that only the new columns remain.</p>
</div>
<div id="task-4" class="section level3" number="3.5.7">
<h3>
<span class="header-section-number">3.5.7</span> Task<a class="anchor" aria-label="anchor" href="#task-4"><i class="fas fa-link"></i></a>
</h3>
<p>The time is currently encoded as decimal (e.g. <code>13.5</code> for 13:30). Create two columns <code>time_hours</code>, which contains the hour (13 in our example), and <code>time_minutes</code>, which contains the minutes, (30 in our example).</p>
<p>You can calculate <code>time_hours</code> as the floor of <code>time</code> (R function <code>floor</code>) and <code>time_minutes</code> as the remainder after integer division of 60 times <code>time</code> by 60 (R operator <code>%%</code>).</p>
</div>
<div id="answer-3" class="section level3" number="3.5.8">
<h3>
<span class="header-section-number">3.5.8</span> Answer<a class="anchor" aria-label="anchor" href="#answer-3"><i class="fas fa-link"></i></a>
</h3>
<p>We can create both columns in one call to <code>mutate</code>.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bikes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>time_hour<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, time_minutes<span class="op">=</span><span class="op">(</span><span class="fl">60</span><span class="op">*</span><span class="va">time</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span><span class="fl">60</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 67,354 × 7
##    name            available_bikes available_bike_…  time total_stands time_hour
##    &lt;chr&gt;                     &lt;int&gt;            &lt;int&gt; &lt;dbl&gt;        &lt;int&gt;     &lt;dbl&gt;
##  1 CHAMPEAUX (BAG…               9               41    13           50        13
##  2 POISSONNIÈRE -…              33                0    13           33        13
##  3 METRO ROME                    6               38    13           44        13
##  4 DE GAULLE (PAN…               2               16    13           18        13
##  5 PARC DE BELLEV…               4               22    13           26        13
##  6 SOLJENITSYNE (…              56                4    13           60        13
##  7 SERRES                        5               18    13           23        13
##  8 PYRAMIDE ARTIL…              14               40    13           54        13
##  9 SAINT GEORGES                12               10    13           22        13
## 10 MUSÉE D'ORSAY                65                0    13           65        13
## # … with 67,344 more rows, and 1 more variable: time_minutes &lt;dbl&gt;</code></pre>
<p>The output does not show the new columns (as they would take the output of a single row to more than one line). We can show them all, for example, if we remove the station name.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bikes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>time_hour<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, time_minutes<span class="op">=</span><span class="op">(</span><span class="fl">60</span><span class="op">*</span><span class="va">time</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span><span class="fl">60</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">name</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 67,354 × 6
##    available_bikes available_bike_sta…  time total_stands time_hour time_minutes
##              &lt;int&gt;               &lt;int&gt; &lt;dbl&gt;        &lt;int&gt;     &lt;dbl&gt;        &lt;dbl&gt;
##  1               9                  41    13           50        13            0
##  2              33                   0    13           33        13            0
##  3               6                  38    13           44        13            0
##  4               2                  16    13           18        13            0
##  5               4                  22    13           26        13            0
##  6              56                   4    13           60        13            0
##  7               5                  18    13           23        13            0
##  8              14                  40    13           54        13            0
##  9              12                  10    13           22        13            0
## 10              65                   0    13           65        13            0
## # … with 67,344 more rows</code></pre>
<p>Alternatively, we can explicitly invoke the print method of the tibble and ask it to print everything.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bikes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>time_hour<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, time_minutes<span class="op">=</span><span class="op">(</span><span class="fl">60</span><span class="op">*</span><span class="va">time</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span><span class="fl">60</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>width<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 67,354 × 7
##    name                       available_bikes available_bike_stands  time
##    &lt;chr&gt;                                &lt;int&gt;                 &lt;int&gt; &lt;dbl&gt;
##  1 CHAMPEAUX (BAGNOLET)                     9                    41    13
##  2 POISSONNIÈRE - ENGHIEN                  33                     0    13
##  3 METRO ROME                               6                    38    13
##  4 DE GAULLE (PANTIN)                       2                    16    13
##  5 PARC DE BELLEVILLE (20040)               4                    22    13
##  6 SOLJENITSYNE (PUTEAUX)                  56                     4    13
##  7 SERRES                                   5                    18    13
##  8 PYRAMIDE ARTILLERIE                     14                    40    13
##  9 SAINT GEORGES                           12                    10    13
## 10 MUSÉE D'ORSAY                           65                     0    13
##    total_stands time_hour time_minutes
##           &lt;int&gt;     &lt;dbl&gt;        &lt;dbl&gt;
##  1           50        13            0
##  2           33        13            0
##  3           44        13            0
##  4           18        13            0
##  5           26        13            0
##  6           60        13            0
##  7           23        13            0
##  8           54        13            0
##  9           22        13            0
## 10           65        13            0
## # … with 67,344 more rows</code></pre>
</div>
<div id="sorting-data-sets-using-arrange" class="section level3" number="3.5.9">
<h3>
<span class="header-section-number">3.5.9</span> Sorting data sets using <code>arrange</code><a class="anchor" aria-label="anchor" href="#sorting-data-sets-using-arrange"><i class="fas fa-link"></i></a>
</h3>
<p>The function <code>arrange</code> can be used to sort a data set by one or more variables.
We can sort the data set <code>bikes</code> by the number of available bikes suing</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bikes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">available_bikes</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 67,354 × 5
##    name                      available_bikes available_bike_…  time total_stands
##    &lt;chr&gt;                               &lt;int&gt;            &lt;int&gt; &lt;dbl&gt;        &lt;int&gt;
##  1 KARMAN (AUBERVILLIERS)                  0                0    13            0
##  2 PIGALLE GERMAIN PILLON                  0               20    13           20
##  3 ROND POINT DES CHAMPS EL…               0                0    13            0
##  4 MONTCALM                                0               47    13           47
##  5 PLACE HENOCQUE VERSION 2                0               34    13           34
##  6 PLACE DES FETES                         0               19    13           19
##  7 MANIN SECRETAN                          0               20    13           20
##  8 MARTINIE (VANVES)                       0               24    13           24
##  9 HORTENSIAS (LES LILAS)                  0               22    13           22
## 10 HAIES REUNION                           0               22    13           22
## # … with 67,344 more rows</code></pre>
<p>You can use the function <code>desc</code> to sort in descending order</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bikes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">available_bikes</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 67,354 × 5
##    name    available_bikes available_bike_stands  time total_stands
##    &lt;chr&gt;             &lt;int&gt;                 &lt;int&gt; &lt;dbl&gt;        &lt;int&gt;
##  1 DUPLEIX              68                     0  16.2           68
##  2 DUPLEIX              68                     0  16.2           68
##  3 DUPLEIX              67                     1  15.4           68
##  4 DUPLEIX              67                     1  15.5           68
##  5 DUPLEIX              67                     1  15.8           68
##  6 DUPLEIX              67                     1  16.1           68
##  7 DUPLEIX              67                     1  16.3           68
##  8 SAHEL                67                     0  17.6           67
##  9 SAHEL                67                     0  18             67
## 10 SAHEL                67                     0  18.1           67
## # … with 67,344 more rows</code></pre>
</div>
<div id="task-5" class="section level3" number="3.5.10">
<h3>
<span class="header-section-number">3.5.10</span> Task<a class="anchor" aria-label="anchor" href="#task-5"><i class="fas fa-link"></i></a>
</h3>
<p>Identify the three bike stations that are furthest to the West (i.e. the ones with the smallest longitude <code>lng</code>).</p>
</div>
<div id="answer-4" class="section level3" number="3.5.11">
<h3>
<span class="header-section-number">3.5.11</span> Answer<a class="anchor" aria-label="anchor" href="#answer-4"><i class="fas fa-link"></i></a>
</h3>
<p>We first sort the stations by the longitude and the select to top three observations.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">lng</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 6
##   name                            id address               lng   lat departement
##   &lt;chr&gt;                        &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      
## 1 GARE ROUTIERE ( SAINT CLOUD) 22101 GARE ROUTIERE - AR…  2.22  48.8 Hauts-de-S…
## 2 SELLIER (SURESNES)           21501 RUE DE SAINT CLOUD…  2.23  48.9 Hauts-de-S…
## 3 VERDUN (SURESNES)            21502 18 BIS RUE DE VERD…  2.23  48.9 Hauts-de-S…</code></pre>
<p>We could have also used the function <code>filter</code> and the ranking function <code>min_rank</code>:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">min_rank</a></span><span class="op">(</span><span class="va">lng</span><span class="op">)</span><span class="op">&lt;=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 6
##   name                            id address               lng   lat departement
##   &lt;chr&gt;                        &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      
## 1 SELLIER (SURESNES)           21501 RUE DE SAINT CLOUD…  2.23  48.9 Hauts-de-S…
## 2 VERDUN (SURESNES)            21502 18 BIS RUE DE VERD…  2.23  48.9 Hauts-de-S…
## 3 GARE ROUTIERE ( SAINT CLOUD) 22101 GARE ROUTIERE - AR…  2.22  48.8 Hauts-de-S…</code></pre>
<p><code>min_rank</code> returns the rank of the observation when considering the variable given as argument (there are many different ways of computing ranks, see <code><a href="https://dplyr.tidyverse.org/reference/ranking.html">?min_rank</a></code> for details.)</p>
<p>However, the latter answer does not show the stations in increasing order of longitude.</p>
</div>
<div id="grouping-data-and-calculating-group-wise-summary-statistics-group_by-and-summarise" class="section level3" number="3.5.12">
<h3>
<span class="header-section-number">3.5.12</span> Grouping data and calculating group-wise summary statistics: <code>group_by</code> and <code>summarise</code><a class="anchor" aria-label="anchor" href="#grouping-data-and-calculating-group-wise-summary-statistics-group_by-and-summarise"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose we want to identify the busiest stations in the system in the sense of having, on average, the most bikes taken out (and thus the highest number of available bike stands – this is assuming JCDecaux replenish all bike stations in the same way, which is not quite what is happening in reality; there are better, but more complex, ways of defining “busy”).</p>
<p>To calculate the average number of available bike stands per station we need to first group the data by bike station and then compute the average number of bike stands available</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bikes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                             <span class="co"># Group by station name</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>avg_stands<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">available_bike_stands</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># Calculate averages</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">avg_stands</span><span class="op">)</span><span class="op">)</span>                              <span class="co"># Sort in descending order</span></code></pre></div>
<pre><code>## # A tibble: 928 × 2
##    name                               avg_stands
##    &lt;chr&gt;                                   &lt;dbl&gt;
##  1 PANTIN                                   70.3
##  2 BELLEVILLE (20041)                       65.1
##  3 PLACE ADOLPHE CHERIOUX                   60  
##  4 HIPPODROME D AUTEUIL                     60.0
##  5 RUE DES BOULETS ( COMPLEMENTAIRE )       55  
##  6 PLACE DE LA PORTE DE CHATILLON           54.9
##  7 PORTE DE LA CHAPELLE                     54.1
##  8 CHARMES (FONTENAY SOUS BOIS)             53.5
##  9 PORTE DE MONTROUGE                       53  
## 10 ALLENDE (PANTIN)                         52.9
## # … with 918 more rows</code></pre>
</div>
<div id="task-6" class="section level3" number="3.5.13">
<h3>
<span class="header-section-number">3.5.13</span> Task<a class="anchor" aria-label="anchor" href="#task-6"><i class="fas fa-link"></i></a>
</h3>
<p>Find the number of bike stations in each département.</p>
<p>You might find the function <code><a href="https://dplyr.tidyverse.org/reference/context.html">n()</a></code> helpful, which returns the number of cases and is the <code>dplyr</code> equivalent of <code>COUNT(*)</code> in SQL (type <code><a href="https://dplyr.tidyverse.org/reference/context.html">?n</a></code> to get help).</p>
</div>
<div id="answer-5" class="section level3" number="3.5.14">
<h3>
<span class="header-section-number">3.5.14</span> Answer<a class="anchor" aria-label="anchor" href="#answer-5"><i class="fas fa-link"></i></a>
</h3>
<p>We can use the following R code:</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">departement</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>         <span class="co"># Group by department</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n_stations<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                <span class="co"># Count cases</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">n_stations</span><span class="op">)</span><span class="op">)</span>                    <span class="co"># Sort in descending order</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
##   departement       n_stations
##   &lt;chr&gt;                  &lt;int&gt;
## 1 Paris                    743
## 2 Hauts-de-Seine            75
## 3 Seine-Saint-Denis         60
## 4 Val-de-Marne              50</code></pre>
<p><code>group_by</code> can be also used to limit the scope of subsequent calls to other functions such as <code>filter</code>, <code>arrange</code> or <code>slice</code>. To make this more concrete, suppose we want to find for each time point the station which the most available bikes. We first have group the data by <code>time</code> and then find the station with the most available bikes.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bikes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                                     
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                           <span class="co"># Group by time</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">available_bikes</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>           <span class="co"># Sort by bikes within each group</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span> <span class="op">(</span><span class="fl">1</span><span class="op">)</span>                                    <span class="co"># Return only top one per group</span></code></pre></div>
<pre><code>## # A tibble: 73 × 5
## # Groups:   time [73]
##    name          available_bikes available_bike_stands  time total_stands
##    &lt;chr&gt;                   &lt;int&gt;                 &lt;int&gt; &lt;dbl&gt;        &lt;int&gt;
##  1 MUSÉE D'ORSAY              65                     0  13             65
##  2 MUSÉE D'ORSAY              65                     0  13.1           65
##  3 MUSÉE D'ORSAY              65                     0  13.2           65
##  4 MUSÉE D'ORSAY              62                     3  13.2           65
##  5 METZ                       64                     0  13.3           64
##  6 DUPLEIX                    64                     4  13.4           68
##  7 METZ                       64                     0  13.5           64
##  8 MUSÉE D'ORSAY              63                     2  13.6           65
##  9 SAINT EMILION              63                     3  13.7           66
## 10 MUSÉE D'ORSAY              65                     0  13.8           65
## # … with 63 more rows</code></pre>
<p>Alternatively, we can use <code>filter</code> and <code>min_rank</code>:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bikes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                                     
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                           <span class="co"># Group by time</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">min_rank</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">available_bikes</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>   <span class="co"># Find largest in each group</span></code></pre></div>
<pre><code>## # A tibble: 92 × 5
## # Groups:   time [73]
##    name                      available_bikes available_bike_…  time total_stands
##    &lt;chr&gt;                               &lt;int&gt;            &lt;int&gt; &lt;dbl&gt;        &lt;int&gt;
##  1 MUSÉE D'ORSAY                          65                0  13             65
##  2 MUSÉE D'ORSAY                          65                0  13.1           65
##  3 MUSÉE D'ORSAY                          65                0  13.2           65
##  4 MUSÉE D'ORSAY                          62                3  13.2           65
##  5 MOUFFETARD EPEE DE BOIS                62                1  13.2           63
##  6 SAINT PLACIDE CHERCHE MI…              62                0  13.2           62
##  7 METZ                                   64                0  13.3           64
##  8 DUPLEIX                                64                4  13.4           68
##  9 METZ                                   64                0  13.4           64
## 10 METZ                                   64                0  13.5           64
## # … with 82 more rows</code></pre>
<p>You might have noticed that the answers differ a little. The reason for this are ties: for example, at 1.15pm the stations at Mussée d’Orsay, Mouffetard Epée de Bois and Sainte Placide Cherche-Midi all had 62 bikes available. The former commands extracts just one of them, whereas the bottom command extracts all three.
(You would obtain the same results if you replaced <code>min_rank</code> by <code>row_number</code>, which breaks ties by using in doubt the order in the data set).</p>
</div>
<div id="merging-joining-data-sets-using-the-join-type-functions" class="section level3" number="3.5.15">
<h3>
<span class="header-section-number">3.5.15</span> Merging (joining) data sets using the <code>join</code>-type functions<a class="anchor" aria-label="anchor" href="#merging-joining-data-sets-using-the-join-type-functions"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose we want to extract the data from <code>bikes</code> relating to bike stations in Hauts-de-Seine only. The table <code>bikes</code> does not however contain any information about the département in which the stations are located. We need to merge the information from the <code>stations</code> and <code>bikes</code>. This can be done using one of the <code>join</code> functions of <code>dplyr</code>. We will use <code>inner_join</code>, which only retains cases if there are corresponding entries in both data sets: this corresponds to the default behaviour of the R function <code>merge</code>.</p>
<p>The <code>join</code> functions will be default use the columns with common names across the two data sets (“natural join”).</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bikes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">stations</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>              <span class="co"># Merge data (using common variable: name)</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">departement</span><span class="op">==</span><span class="st">"Hauts-de-Seine"</span><span class="op">)</span></code></pre></div>
<pre><code>## Joining, by = "name"</code></pre>
<pre><code>## # A tibble: 5,333 × 10
##    name  available_bikes available_bike_…  time total_stands    id address   lng
##    &lt;chr&gt;           &lt;int&gt;            &lt;int&gt; &lt;dbl&gt;        &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;
##  1 SOLJ…              56                4    13           60 28002 BOULEV…  2.25
##  2 DE G…               3               19    13           22 22005 195 AV…  2.26
##  3 NATI…              20                3    13           23 21015 39 RUE…  2.24
##  4 MONT…              20                5    13           25 22011 7 RUE …  2.28
##  5 PETI…              22                0    13           22 21113 2 RUE …  2.30
##  6 GREN…               9               12    13           21 21013 4 AVEN…  2.25
##  7 MART…               0               24    13           24 21703 5-7 AV…  2.29
##  8 MORI…              22                3    13           25 21106 2-4 RU…  2.31
##  9 SELL…              34               17    13           51 21501 RUE DE…  2.23
## 10 VALI…              22                2    13           24 21101 4 RUE …  2.30
## # … with 5,323 more rows, and 2 more variables: lat &lt;dbl&gt;, departement &lt;chr&gt;</code></pre>
<p>We could have specified the column to used to join the data sets manually by adding the argument <code>by="name"</code> (or <code>by=c("name"="name")</code>, which allows using columns with different names in the two data set).</p>
<p>As a side note, in this example, we could have avoided joining the two tables. We could have first extracted the names of the stations in Hauts-de-Seine and then used those to subset the data from <code>bikes</code> (essentially the equivalent of a subquery in SQL):</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">names92</span> <span class="op">&lt;-</span> <span class="va">stations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">departement</span><span class="op">==</span><span class="st">"Hauts-de-Seine"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> 
<span class="va">bikes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">names92</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> </code></pre></div>
<pre><code>## # A tibble: 5,333 × 5
##    name                      available_bikes available_bike_…  time total_stands
##    &lt;chr&gt;                               &lt;int&gt;            &lt;int&gt; &lt;dbl&gt;        &lt;int&gt;
##  1 SOLJENITSYNE (PUTEAUX)                 56                4    13           60
##  2 DE GAULLE 3 (NEUILLY)                   3               19    13           22
##  3 NATIONALE (BOULOGNE-BILL…              20                3    13           23
##  4 MONTROSIER (NEUILLY)                   20                5    13           25
##  5 PETIT (CLICHY)                         22                0    13           22
##  6 GRENIER (BOULOGNE-BILLAN…               9               12    13           21
##  7 MARTINIE (VANVES)                       0               24    13           24
##  8 MORICE 2 (CLICHY)                      22                3    13           25
##  9 SELLIER (SURESNES)                     34               17    13           51
## 10 VALITON (CLICHY)                       22                2    13           24
## # … with 5,323 more rows</code></pre>
<p>We had to use <code>names92[[1]]</code> to extract the entries of the tibble <code>names92</code> as a character vector (we could have also used <code>unlist(names92)</code>).</p>
<p>You might notice a small difference in the results returned by the two approaches. The former retains the columns from <code>stations</code> which we have inserted, whereas the latter only contains the columns which <code>bikes</code> contained to start with.</p>
</div>
<div id="additional-resources-2" class="section level3" number="3.5.16">
<h3>
<span class="header-section-number">3.5.16</span> Additional Resources<a class="anchor" aria-label="anchor" href="#additional-resources-2"><i class="fas fa-link"></i></a>
</h3>
<p><a href="%22https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf%22">Data Transformation Cheat Sheet</a>
RStudio have put together a very handy and compact cheat sheet for dplyr.</p>
<p><a href="%22http://r4ds.had.co.nz/relational-data.html%22,%20icon=%22book%22">Background reading: Chapter 13 of R for Data Science</a>
Chapter 13 of <em>R for Data Science</em> gives a detailed overview of the functions in <code>dplyr</code>.</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="intro.html"><span class="header-section-number">2</span> Getting Started</a></div>
<div class="next"><a href="creating-graphics-with-ggplot2.html"><span class="header-section-number">4</span> Creating Graphics with ggplot2</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#efficient-data-management-in-r"><span class="header-section-number">3</span> Efficient Data Management in R</a></li>
<li><a class="nav-link" href="#tidyverse"><span class="header-section-number">3.1</span> Tidyverse</a></li>
<li>
<a class="nav-link" href="#pipelines"><span class="header-section-number">3.2</span> Pipelines</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#task"><span class="header-section-number">3.2.1</span> Task</a></li>
<li><a class="nav-link" href="#solution"><span class="header-section-number">3.2.2</span> Solution</a></li>
<li><a class="nav-link" href="#task-1"><span class="header-section-number">3.2.3</span> Task</a></li>
<li><a class="nav-link" href="#answer"><span class="header-section-number">3.2.4</span> Answer</a></li>
<li><a class="nav-link" href="#additional-resources"><span class="header-section-number">3.2.5</span> Additional Resources</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#tibbles"><span class="header-section-number">3.3</span> Tibbles</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#creating-tibbles"><span class="header-section-number">3.3.1</span> Creating tibbles</a></li>
<li><a class="nav-link" href="#working-with-tibbles"><span class="header-section-number">3.3.2</span> Working with tibbles</a></li>
<li><a class="nav-link" href="#subsetting-tibbles-always-results-in-a-tibble"><span class="header-section-number">3.3.3</span> Subsetting tibbles always results in a tibble</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#reading-in-data-using-readr"><span class="header-section-number">3.4</span> Reading in data using readr</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#task-2"><span class="header-section-number">3.4.1</span> Task</a></li>
<li><a class="nav-link" href="#answer-1"><span class="header-section-number">3.4.2</span> Answer</a></li>
<li><a class="nav-link" href="#specifying-column-types"><span class="header-section-number">3.4.3</span> Specifying column types</a></li>
<li><a class="nav-link" href="#additional-resources-1"><span class="header-section-number">3.4.4</span> Additional Resources</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#efficient-data-manipulation-using-dplyr"><span class="header-section-number">3.5</span> Efficient data manipulation using dplyr</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#overview-the-key-functions-verbs-for-dplyr"><span class="header-section-number">3.5.1</span> Overview: the key functions (“verbs”) for dplyr</a></li>
<li><a class="nav-link" href="#selecting-observations-rows-using-filter-and-slice"><span class="header-section-number">3.5.2</span> Selecting observations (rows) using filter and slice</a></li>
<li><a class="nav-link" href="#task-3"><span class="header-section-number">3.5.3</span> Task</a></li>
<li><a class="nav-link" href="#answer-2"><span class="header-section-number">3.5.4</span> Answer</a></li>
<li><a class="nav-link" href="#selecting-variables-columns-using-select"><span class="header-section-number">3.5.5</span> Selecting variables (columns) using select</a></li>
<li><a class="nav-link" href="#adding-new-variables-using-mutate"><span class="header-section-number">3.5.6</span> Adding new variables using mutate</a></li>
<li><a class="nav-link" href="#task-4"><span class="header-section-number">3.5.7</span> Task</a></li>
<li><a class="nav-link" href="#answer-3"><span class="header-section-number">3.5.8</span> Answer</a></li>
<li><a class="nav-link" href="#sorting-data-sets-using-arrange"><span class="header-section-number">3.5.9</span> Sorting data sets using arrange</a></li>
<li><a class="nav-link" href="#task-5"><span class="header-section-number">3.5.10</span> Task</a></li>
<li><a class="nav-link" href="#answer-4"><span class="header-section-number">3.5.11</span> Answer</a></li>
<li><a class="nav-link" href="#grouping-data-and-calculating-group-wise-summary-statistics-group_by-and-summarise"><span class="header-section-number">3.5.12</span> Grouping data and calculating group-wise summary statistics: group_by and summarise</a></li>
<li><a class="nav-link" href="#task-6"><span class="header-section-number">3.5.13</span> Task</a></li>
<li><a class="nav-link" href="#answer-5"><span class="header-section-number">3.5.14</span> Answer</a></li>
<li><a class="nav-link" href="#merging-joining-data-sets-using-the-join-type-functions"><span class="header-section-number">3.5.15</span> Merging (joining) data sets using the join-type functions</a></li>
<li><a class="nav-link" href="#additional-resources-2"><span class="header-section-number">3.5.16</span> Additional Resources</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Visualising Data using R</strong>" was written by Craig Alexander, Eilidh Jack &amp; Marnie Low. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
